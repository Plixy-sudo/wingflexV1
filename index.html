<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wingflex | Aeroelasticity</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>✈️</text></svg>">

    <style>
        /* --- 1. CORE VARIABLES & RESET --- */
        :root {
            --bg-body: #fafafa;
            --bg-surface: #ffffff;
            --text-primary: #111827;
            --text-secondary: #6b7280;
            --accent: #2563eb;
            --accent-danger: #ef4444;
            --border: #e5e7eb;
            --radius-lg: 24px;
            --shadow-float: 0 20px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04);
            --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            --transition-smooth: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }

        html { scroll-behavior: smooth; }
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: var(--font-sans);
            background-color: var(--bg-body);
            color: var(--text-primary);
            -webkit-font-smoothing: antialiased;
            overflow-x: hidden;
        }

        /* --- 2. UI ANIMATIONS --- */
        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- 3. UI COMPONENTS --- */
        .container { max-width: 1100px; margin: 0 auto; padding: 0 2rem; }

        .btn {
            display: inline-flex; align-items: center; justify-content: center;
            padding: 1rem 2rem; background: var(--text-primary); color: white;
            border-radius: 50px; font-weight: 600; transition: var(--transition-smooth);
            border: none; cursor: pointer; letter-spacing: 0.5px;
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(0,0,0,0.2); background: black; }

        /* --- 4. NAVIGATION --- */
        nav {
            position: fixed; top: 0; left: 0; right: 0; padding: 1.25rem 0; z-index: 1000;
            background: rgba(250, 250, 250, 0.7); backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        .nav-content { display: flex; justify-content: space-between; align-items: center; }
        .logo { font-weight: 800; font-size: 1.2rem; letter-spacing: -0.5px; display: flex; align-items: center; gap: 8px; }
        .logo-dot { width: 8px; height: 8px; background: var(--accent); border-radius: 50%; }
        .nav-items a { color: var(--text-secondary); text-decoration: none; margin-left: 2rem; font-size: 0.9rem; font-weight: 500; transition: color 0.2s; }
        .nav-items a:hover { color: var(--text-primary); }

        /* --- 5. HERO & SECTIONS --- */
        .hero { padding-top: 180px; padding-bottom: 100px; text-align: center; }
        .hero h1 { font-size: 4.5rem; line-height: 1.1; font-weight: 800; letter-spacing: -2px; margin-bottom: 1.5rem; opacity: 0; animation: fadeUp 0.8s ease-out forwards; }
        .hero p { font-size: 1.3rem; color: var(--text-secondary); max-width: 600px; margin: 0 auto 3rem; line-height: 1.6; opacity: 0; animation: fadeUp 0.8s ease-out 0.2s forwards; }
        .hero-visual { width: 100%; height: 500px; border-radius: var(--radius-lg); overflow: hidden; box-shadow: var(--shadow-float); opacity: 0; animation: fadeUp 1s ease 0.4s forwards; }
        .hero-visual img { width: 100%; height: 100%; object-fit: cover; transition: transform 2s ease; }
        
        .grid-section { padding: 8rem 0; }
        .section-header { margin-bottom: 4rem; display: flex; justify-content: space-between; align-items: flex-end; }
        .section-header h2 { font-size: 2.5rem; letter-spacing: -1px; }

        /* --- 6. CARDS --- */
        .cards-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 2.5rem; }
        .card { background: var(--bg-surface); border-radius: var(--radius-lg); overflow: hidden; cursor: pointer; transition: var(--transition-smooth); border: 1px solid var(--border); }
        .card:hover { transform: translateY(-8px); box-shadow: var(--shadow-float); }
        .card-img-container { height: 240px; overflow: hidden; }
        .card-img-container img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s ease; }
        .card:hover .card-img-container img { transform: scale(1.1); }
        .card-body { padding: 2rem; }
        .tag { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1px; font-weight: 700; color: var(--accent); margin-bottom: 1rem; display: block; }
        .card h3 { font-size: 1.5rem; margin-bottom: 0.75rem; font-weight: 700; }
        .read-indicator { margin-top: 1.5rem; font-size: 0.9rem; font-weight: 600; opacity: 0; transform: translateX(-10px); transition: var(--transition-smooth); }
        .card:hover .read-indicator { opacity: 1; transform: translateX(0); }

        /* --- 7. F1 GAME STYLES (SCOPED) --- */
        #f1-game-root {
            position: relative;
            background: #020408; /* Dark tunnel */
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-float);
            aspect-ratio: 16/9;
            /* F1 Variables */
            --f1-accent: #fcd700;
            --f1-highlight: #ea0a1e;
            --f1-ford-blue: #4aa1f3;
            --f1-font: 'Segoe UI Mono', 'Courier New', monospace;
        }

        #f1-game-root canvas { display: block; width: 100%; height: 100%; }

        /* Floating HUD */
        #f1-hud {
            position: absolute; top: 20px; left: 20px;
            pointer-events: none; z-index: 10;
            display: flex; flex-direction: column; gap: 15px;
        }

        .f1-metric, .f1-controls { pointer-events: auto; text-shadow: 0 2px 10px rgba(0,0,0,0.8); }
        .f1-metric label, .f1-controls label {
            display: block; font-size: 10px; text-transform: uppercase; opacity: 0.5;
            letter-spacing: 2px; margin-bottom: 4px; font-weight: 600; color: white;
        }
        .f1-metric .value {
            font-size: 32px; font-weight: 300; line-height: 1; color: #fff;
            font-variant-numeric: tabular-nums;
        }
        .f1-unit { font-size: 12px; opacity: 0.6; font-weight: 400; margin-left: 5px; color: white; }

        /* Slider */
        #f1-speed-slider {
            -webkit-appearance: none; width: 180px; background: transparent; margin-top: 10px;
        }
        #f1-speed-slider:focus { outline: none; }
        #f1-speed-slider::-webkit-slider-runnable-track {
            width: 100%; height: 2px; cursor: pointer; background: rgba(255,255,255,0.2);
            border-radius: 1px; transition: background 0.3s;
        }
        #f1-speed-slider:hover::-webkit-slider-runnable-track { background: rgba(255,255,255,0.4); }
        #f1-speed-slider::-webkit-slider-thumb {
            height: 12px; width: 12px; border-radius: 50%; background: #fff;
            cursor: pointer; -webkit-appearance: none; margin-top: -5px; 
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5); transition: transform 0.2s, background 0.2s;
        }
        #f1-speed-slider::-webkit-slider-thumb:hover { transform: scale(1.3); background: var(--f1-ford-blue); }

        /* Heat Bar */
        #f1-heat-container {
            position: absolute; bottom: 0; left: 0; width: 100%; pointer-events: none; z-index: 10;
        }
        #f1-heat-label {
            position: absolute; bottom: 15px; width: 100%; text-align: center;
            font-size: 10px; letter-spacing: 4px; color: var(--f1-highlight);
            opacity: 0; transition: opacity 0.3s; font-weight: 700;
            text-shadow: 0 0 15px var(--f1-highlight); text-transform: uppercase;
        }
        #f1-heat-bar-bg { width: 100%; height: 4px; background: rgba(255,255,255,0.05); }
        #f1-heat-bar-fill {
            width: 0%; height: 100%; background: var(--f1-highlight);
            transition: width 0.1s linear; box-shadow: 0 0 20px var(--f1-highlight);
        }

        /* Overlay */
        #f1-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(2, 4, 8, 0.9); display: flex; flex-direction: column;
            justify-content: center; align-items: center; z-index: 100;
            backdrop-filter: blur(20px); transition: opacity 0.6s ease;
        }
        #f1-overlay.hidden { opacity: 0; pointer-events: none; }
        #f1-overlay h1 { font-size: 24px; letter-spacing: 12px; font-weight: 300; margin: 0 0 40px 0; color: #fff; text-transform: uppercase; animation: none; opacity: 1; }
        #f1-overlay p { color: #889; margin-bottom: 60px; text-align: center; line-height: 2; font-size: 11px; letter-spacing: 1px; text-transform: uppercase; max-width: 400px; animation: none; opacity: 1; }
        #f1-overlay strong { color: var(--f1-ford-blue); font-weight: 600; }
        .f1-big-btn {
            background: transparent; color: #fff; border: 1px solid rgba(255,255,255,0.2);
            padding: 15px 50px; font-family: var(--font-sans); font-size: 11px;
            cursor: pointer; text-transform: uppercase; letter-spacing: 4px;
            transition: all 0.3s ease; border-radius: 2px;
        }
        .f1-big-btn:hover { border-color: #fff; background: rgba(255, 255, 255, 0.05); letter-spacing: 6px; }


        /* --- 8. CALCULATOR --- */
        .calculator-wrapper {
            background: var(--text-primary); color: white; border-radius: var(--radius-lg);
            padding: 4rem; display: grid; grid-template-columns: 1fr 1fr; gap: 4rem; align-items: center;
            margin-bottom: 4rem; position: relative; overflow: hidden;
        }
        .calculator-wrapper input { width: 100%; background: transparent; border: none; border-bottom: 2px solid rgba(255,255,255,0.2); font-size: 3rem; color: white; padding: 1rem 0; outline: none; }
        .big-number { font-size: 6rem; font-weight: 800; line-height: 1; background: linear-gradient(to bottom right, #ffffff, #94a3b8); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        /* --- 9. MODAL --- */
        .modal-backdrop {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.95); z-index: 2000; opacity: 0; pointer-events: none;
            transition: opacity 0.4s ease; backdrop-filter: blur(5px); overflow-y: auto;
        }
        .modal-backdrop.active { opacity: 1; pointer-events: all; }
        .modal-content { max-width: 800px; margin: 4rem auto 8rem auto; padding: 0 2rem; opacity: 0; transform: translateY(50px); transition: 0.5s; }
        .modal-backdrop.active .modal-content { opacity: 1; transform: translateY(0); }
        .close-modal { position: fixed; top: 2rem; right: 2rem; width: 50px; height: 50px; border-radius: 50%; background: var(--bg-surface); border: 1px solid var(--border); cursor: pointer; font-size: 1.5rem; z-index: 2001; }
        
        .article-hero-img { width: 100%; height: 400px; object-fit: cover; border-radius: var(--radius-lg); margin-bottom: 3rem; }
        .article-text h1 { font-size: 3rem; line-height: 1.1; margin-bottom: 1rem; }
        .article-text p { font-size: 1.2rem; line-height: 1.8; color: #374151; margin-bottom: 2rem; }
        .article-text h3 { margin-top: 3rem; margin-bottom: 1rem; font-size: 1.5rem; }
        .article-text ul { margin-left: 1.5rem; margin-bottom: 2rem; line-height: 1.8; font-size: 1.2rem; color: #374151; }

        .reveal-on-scroll { opacity: 0; transform: translateY(40px); transition: 0.8s ease-out; }
        .reveal-on-scroll.is-visible { opacity: 1; transform: translateY(0); }

        /* --- 10. SECRET OVERLAY --- */
        #secret-frame {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            border: none; z-index: 9999; background: white;
            opacity: 0; pointer-events: none; transition: opacity 0.5s ease;
        }
        #secret-frame.active { opacity: 1; pointer-events: all; }

        @media (max-width: 768px) {
            .hero h1 { font-size: 3rem; }
            .calculator-wrapper { grid-template-columns: 1fr; padding: 2rem; gap: 2rem; }
        }
    </style>
</head>
<body>

    <nav>
        <div class="container nav-content">
            <div class="logo"><div class="logo-dot"></div>WINGFLEX</div>
            <div class="nav-items">
                <a href="#journal">Journal</a>
                <a href="#lab">Wind Tunnel</a>
                <a href="#about">About</a>
            </div>
        </div>
    </nav>

    <header class="container hero">
        <h1>Bending the rules<br>of aerodynamics.</h1>
        <p>A deep dive into structural flexibility, load factors, and why modern planes are designed to act like giant springs.</p>
        <button class="btn" onclick="document.getElementById('journal').scrollIntoView()">Start Exploring</button>
        <div style="height: 60px;"></div>
        <div class="hero-visual">
            <img src="https://images.unsplash.com/photo-1464037866556-6812c9d1c72e?ixlib=rb-4.0.3&auto=format&fit=crop&w=2000&q=80" alt="Wing Flex">
        </div>
    </header>

    <section id="journal" class="container grid-section">
        <div class="section-header reveal-on-scroll">
            <h2>The Engineering Journal</h2>
            <p style="color: var(--text-secondary)">Curated insights into aviation physics.</p>
        </div>
        <div class="cards-grid">
            <div class="card reveal-on-scroll" onclick="openModal(0)">
                <div class="card-img-container"><img src="https://images.unsplash.com/photo-1520437358207-323b43b50729?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" alt="787 Wing"></div>
                <div class="card-body">
                    <span class="tag">Materials</span>
                    <h3>The Carbon Fiber Revolution</h3>
                    <p>How composite materials allow the Boeing 787 to flex its wings by over 25 feet without snapping.</p>
                    <div class="read-indicator">Read Article →</div>
                </div>
            </div>
            <div class="card reveal-on-scroll" style="transition-delay: 100ms" onclick="openModal(1)">
                <div class="card-img-container"><img src="https://images.unsplash.com/photo-1540962351504-03099e0a754b?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" alt="Fighter Jet"></div>
                <div class="card-body">
                    <span class="tag">Physics</span>
                    <h3>Understanding Load Factor</h3>
                    <p>Why a 60-degree turn makes your plane feel twice as heavy, and the math behind G-Force limits.</p>
                    <div class="read-indicator">Read Article →</div>
                </div>
            </div>
            <div class="card reveal-on-scroll" style="transition-delay: 200ms" onclick="openModal(2)">
                <div class="card-img-container"><img src="https://images.unsplash.com/photo-1583070675712-421b44321683?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" alt="Turbulence"></div>
                <div class="card-body">
                    <span class="tag">Safety</span>
                    <h3>The "Ultimate Load" Test</h3>
                    <p>Engineers purposely break wings in the hangar to prove they won't break in the sky.</p>
                    <div class="read-indicator">Read Article →</div>
                </div>
            </div>
        </div>
    </section>

    <section id="lab" class="container grid-section">
        <div class="section-header reveal-on-scroll">
            <h2>Aerodynamic Lab</h2>
            <p style="color: var(--text-secondary)">Simulation tools for fluid dynamics.</p>
        </div>

        <div class="calculator-wrapper reveal-on-scroll">
            <div class="calc-input-area">
                <h3 style="margin-bottom: 2rem; font-size: 1.5rem;">Bank Angle Calculator</h3>
                <div style="margin-bottom: 2rem; position: relative;">
                    <label style="font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; opacity: 0.7;">Angle (Degrees)</label>
                    <input type="number" id="bankInput" placeholder="45" value="45">
                </div>
                <button class="btn" style="background: white; color: black;" onclick="animateCalculation()">Calculate G-Load</button>
            </div>
            <div class="result-display" style="text-align: right;">
                <div class="big-number" id="calcDisplay">1.41</div>
                <div style="font-size: 1.5rem; opacity: 0.7;">G-Force Load</div>
            </div>
        </div>

        <!-- F1 GAME EMBED -->
        <div id="f1-game-root" class="reveal-on-scroll">
            
            <div id="f1-hud">
                <div class="f1-metric">
                    <label>Tunnel Speed</label>
                    <div class="value"><span id="f1-speed-val">0</span><span class="f1-unit">MPH</span></div>
                </div>
                <div class="f1-controls">
                    <label>Velocity</label>
                    <input type="range" id="f1-speed-slider" min="10" max="300" step="10" value="90">
                </div>
            </div>

            <div id="f1-heat-container">
                <div id="f1-heat-label">THERMAL CRITICAL</div>
                <div id="f1-heat-bar-bg"><div id="f1-heat-bar-fill"></div></div>
            </div>

            <div id="f1-overlay">
                <h1>RB22 FORD</h1>
                <p>
                    Maintain position within the <strong>Flow Zone</strong>.<br>
                    Manage velocity to capture data.<br>
                    Avoid overheating.
                </p>
                <button id="f1-start-btn" class="f1-big-btn">Start Engine</button>
            </div>

            <canvas id="f1-canvas"></canvas>
        </div>
    </section>

    <footer style="text-align: center; padding: 4rem 0; color: var(--text-secondary); font-size: 0.9rem;">
        <p>&copy; 2026 Wingflex Education. Designed for modern aviators.</p>
    </footer>

    <div class="modal-backdrop" id="modalBackdrop">
        <button class="close-modal" onclick="closeModal()">×</button>
        <div class="modal-content">
            <img id="mImage" class="article-hero-img" src="">
            <div class="article-text">
                <span id="mTag" class="tag">CATEGORY</span>
                <h1 id="mTitle">Article Title</h1>
                <div id="mBody">Content goes here...</div>
            </div>
        </div>
    </div>

    <iframe id="secret-frame" src=""></iframe>

    <script>
        // --- 1. GENERAL SCROLL OBSERVER ---
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                    observer.unobserve(entry.target);
                }
            });
        }, { threshold: 0.1 });
        document.querySelectorAll('.reveal-on-scroll').forEach(el => observer.observe(el));

        // --- 2. CALCULATOR LOGIC ---
        function animateCalculation() {
            const input = document.getElementById('bankInput');
            const display = document.getElementById('calcDisplay');
            let angle = parseFloat(input.value);
            if (isNaN(angle) || angle < 0 || angle >= 90) return;

            const target = 1 / Math.cos(angle * (Math.PI / 180));
            let current = 0;
            const step = target / 30;
            function update() {
                current += step;
                if (current >= target) display.textContent = target.toFixed(2);
                else { display.textContent = current.toFixed(2); requestAnimationFrame(update); }
            }
            update();
        }

        // --- 3. F1 WIND TUNNEL SIMULATOR (RB22) ---
        const f1Canvas = document.getElementById('f1-canvas');
        const f1Ctx = f1Canvas.getContext('2d');
        const f1UiSpeed = document.getElementById('f1-speed-val');
        const f1UiSlider = document.getElementById('f1-speed-slider');
        const f1UiHeatFill = document.getElementById('f1-heat-bar-fill');
        const f1UiHeatLabel = document.getElementById('f1-heat-label');
        const f1Overlay = document.getElementById('f1-overlay');
        const f1BtnStart = document.getElementById('f1-start-btn');

        let f1W, f1H;
        let isPlaying = false;
        let animationId;

        // Variables
        let score = 0;
        let heat = 0;
        let currentMPH = 90;
        let windSpeed = 14.48; 
        
        let zone = { y: 0, h: 220 };
        let car = { x: 0, y: 0, w: 260, h: 60 };
        let isDragging = false;
        let dragOffset = { x: 0, y: 0 };
        let particles = [];

        function resizeF1() {
            const rect = f1Canvas.parentElement.getBoundingClientRect();
            f1W = f1Canvas.width = rect.width;
            f1H = f1Canvas.height = rect.height;
            
            if(!isPlaying) {
                car.x = f1W/2 - car.w/2;
                car.y = f1H/2 - car.h/2;
            }
            zone.y = f1H/2 - zone.h/2;
        }
        window.addEventListener('resize', resizeF1);
        resizeF1();

        // PARTICLE SYSTEM
        class Particle {
            constructor() { this.reset(true); }
            reset(randomX = false) {
                this.x = randomX ? Math.random() * f1W : -200;
                this.y = Math.random() * f1H;
                this.vx = 0; this.vy = 0;
                this.baseSpeed = Math.random() * 5; 
                this.alpha = Math.random() * 0.3 + 0.1;
            }
            update() {
                let targetVx = windSpeed + this.baseSpeed;
                let targetVy = 0;
                const relX = this.x - car.x;
                const relY = this.y - car.y; 

                // 2026 PROFILE AERO
                if (relX > -100 && relX < car.w + 150) {
                    let surfaceY = 100; 
                    if (relX < 0) surfaceY = 48; 
                    else if (relX >= 0 && relX < 90) surfaceY = 48 - (relX/90) * 20; 
                    else if (relX >= 90 && relX < 140) surfaceY = 28; 
                    else if (relX >= 140 && relX < 235) surfaceY = 20 + ((relX - 140) / 95) * 25; 
                    else if (relX >= 235) surfaceY = 20; 

                    const buffer = 15; const floorY = 55;
                    if (relY > surfaceY - buffer && relY < floorY) {
                        const depth = relY - (surfaceY - buffer);
                        if (depth > 0) {
                            const pushForce = depth / 30; 
                            targetVy -= pushForce * windSpeed * 1.5; 
                            targetVx += pushForce * windSpeed * 0.5;
                        }
                    }
                    if (relY >= floorY && relY < floorY + 15 && relX > 20 && relX < 210) targetVx += windSpeed * 0.45; 
                    if (relX > 240 && relX < 450) {
                        if (relY < 40 && relY > -30) {
                            targetVy -= windSpeed * 0.5 * (1 - (relX-240)/210); targetVx *= 0.95;
                        }
                    }
                    if (relX > -20 && relX < 10 && relY > 45) targetVy += windSpeed * 0.2;
                }
                this.vx += (targetVx - this.vx) * 0.2;
                this.vy += (targetVy - this.vy) * 0.2;
                this.x += this.vx; this.y += this.vy;

                // Visuals
                const inZone = (car.y >= zone.y && car.y + car.h <= zone.y + zone.h);
                const nearCar = relX > -50 && relX < 350 && Math.abs(relY - 30) < 60;
                
                if (nearCar) this.color = inZone ? `rgba(74, 161, 243, ${this.alpha})` : `rgba(234, 10, 30, ${this.alpha})`;
                else this.color = `rgba(200, 210, 220, ${this.alpha * 0.6})`;

                if (this.x > f1W + 200 || this.y < -100 || this.y > f1H + 100) this.reset();
            }
            draw() {
                f1Ctx.strokeStyle = this.color;
                f1Ctx.lineWidth = 1.5;
                f1Ctx.beginPath();
                f1Ctx.moveTo(this.x, this.y);
                f1Ctx.lineTo(this.x - (this.vx * 3.0), this.y - (this.vy * 3.0));
                f1Ctx.stroke();
            }
        }

        // RENDERER
        function drawF1Car() {
            f1Ctx.save();
            f1Ctx.translate(car.x, car.y);
            if (heat > 0) { f1Ctx.shadowBlur = heat * 0.8; f1Ctx.shadowColor = '#ea0a1e'; }

            const cPrim = '#000814'; const cFord = '#4aa1f3'; 
            const cYell = '#fcd700'; const cRed = '#ea0a1e'; const cCarb = '#1a1a1a';

            // Chassis
            f1Ctx.fillStyle = cPrim; f1Ctx.beginPath();
            f1Ctx.moveTo(0, 48); f1Ctx.bezierCurveTo(30, 46, 60, 40, 90, 38); f1Ctx.lineTo(130, 30); 
            f1Ctx.lineTo(155, 22); f1Ctx.bezierCurveTo(190, 22, 220, 28, 235, 45); 
            f1Ctx.lineTo(240, 25); f1Ctx.lineTo(260, 22); f1Ctx.lineTo(260, 50); 
            f1Ctx.lineTo(220, 55); f1Ctx.lineTo(60, 55); f1Ctx.closePath(); f1Ctx.fill();

            // Pattern & Branding
            f1Ctx.fillStyle = cFord; f1Ctx.globalAlpha = 0.2; f1Ctx.beginPath();
            f1Ctx.moveTo(140, 40); f1Ctx.lineTo(180, 50); f1Ctx.lineTo(120, 50); f1Ctx.fill(); f1Ctx.globalAlpha = 1.0;
            f1Ctx.fillStyle = '#fff'; f1Ctx.font = 'bold 7px Arial'; f1Ctx.fillText("ORACLE", 140, 48);
            f1Ctx.font = 'bold 8px Arial'; f1Ctx.fillText("FORD", 185, 35);
            f1Ctx.fillStyle = '#fff'; f1Ctx.beginPath(); f1Ctx.arc(160, 26, 9, 0, Math.PI * 2); f1Ctx.fill();
            f1Ctx.fillStyle = cYell; f1Ctx.beginPath(); f1Ctx.arc(160, 26, 7, 0, Math.PI * 2); f1Ctx.fill();
            f1Ctx.strokeStyle = cRed; f1Ctx.lineWidth = 1.5; f1Ctx.beginPath(); f1Ctx.moveTo(165, 20); f1Ctx.lineTo(220, 28); f1Ctx.stroke();
            
            // Nose & Wings
            f1Ctx.fillStyle = cYell; f1Ctx.beginPath(); f1Ctx.moveTo(0, 48); f1Ctx.lineTo(20, 46); f1Ctx.lineTo(20, 50); f1Ctx.fill();
            f1Ctx.fillStyle = cPrim; f1Ctx.beginPath(); f1Ctx.moveTo(5, 48); f1Ctx.lineTo(45, 45); f1Ctx.lineTo(45, 50); f1Ctx.lineTo(5, 52); f1Ctx.fill();
            f1Ctx.fillStyle = cRed; f1Ctx.fillRect(5, 48, 35, 1); f1Ctx.fillStyle = cFord; f1Ctx.fillRect(43, 45, 2, 8);
            
            f1Ctx.fillStyle = cPrim; f1Ctx.beginPath(); f1Ctx.moveTo(240, 25); f1Ctx.bezierCurveTo(240, 18, 255, 16, 260, 18); f1Ctx.lineTo(260, 32); f1Ctx.lineTo(250, 30); f1Ctx.lineTo(235, 28); f1Ctx.fill();
            f1Ctx.fillStyle = cFord; f1Ctx.fillRect(258, 18, 2, 14);
            f1Ctx.strokeStyle = cPrim; f1Ctx.lineWidth = 3; f1Ctx.beginPath(); f1Ctx.arc(140, 28, 11, Math.PI, 0); f1Ctx.stroke();

            // Wheels
            f1Ctx.fillStyle = '#111'; f1Ctx.beginPath(); f1Ctx.arc(45, 52, 21, 0, Math.PI*2); f1Ctx.fill(); f1Ctx.beginPath(); f1Ctx.arc(195, 52, 21, 0, Math.PI*2); f1Ctx.fill();
            f1Ctx.strokeStyle = cFord; f1Ctx.lineWidth = 1; f1Ctx.beginPath(); f1Ctx.arc(45, 52, 16, 0, Math.PI*2); f1Ctx.stroke(); f1Ctx.beginPath(); f1Ctx.arc(195, 52, 16, 0, Math.PI*2); f1Ctx.stroke();
            f1Ctx.restore();
        }

        function drawGrid() {
            f1Ctx.strokeStyle = 'rgba(255, 255, 255, 0.02)'; f1Ctx.lineWidth = 1; const gs = 100;
            for(let x=0; x<=f1W; x+=gs) { f1Ctx.beginPath(); f1Ctx.moveTo(x, 0); f1Ctx.lineTo(x, f1H); f1Ctx.stroke(); }
            for(let y=0; y<=f1H; y+=gs) { f1Ctx.beginPath(); f1Ctx.moveTo(0, y); f1Ctx.lineTo(f1W, y); f1Ctx.stroke(); }
        }

        function drawZone() {
            f1Ctx.fillStyle = 'rgba(74, 161, 243, 0.02)'; f1Ctx.fillRect(0, zone.y, f1W, zone.h);
            f1Ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)'; f1Ctx.lineWidth = 1;
            f1Ctx.beginPath(); f1Ctx.moveTo(0, zone.y); f1Ctx.lineTo(f1W, zone.y); f1Ctx.stroke();
            f1Ctx.beginPath(); f1Ctx.moveTo(0, zone.y + zone.h); f1Ctx.lineTo(f1W, zone.y + zone.h); f1Ctx.stroke();
            f1Ctx.fillStyle = 'rgba(255, 255, 255, 0.2)'; f1Ctx.font = '9px sans-serif'; f1Ctx.fillText("OPTIMAL FLOW", 20, zone.y + 12);
        }

        // GAME LOOP
        function startGame() {
            score = 0; heat = 0; currentMPH = 90; f1UiSlider.value = 90;
            particles = []; for(let i=0; i<600; i++) particles.push(new Particle());
            isPlaying = true; f1Overlay.classList.add('hidden');
            animateF1();
        }

        function updateF1() {
            windSpeed = currentMPH / 6.2;
            const inZone = (car.y >= zone.y && car.y + car.h <= zone.y + zone.h);
            if (inZone) { score += windSpeed / 10; heat = Math.max(0, heat - 0.4); } else { heat += 0.5; }
            if (heat >= 100) { isPlaying = false; f1Overlay.classList.remove('hidden'); }
            
            f1UiSpeed.innerText = currentMPH;
            f1UiHeatFill.style.width = heat + "%";
            if (heat > 0) { f1UiHeatLabel.style.opacity = Math.min(1, heat/50); f1UiHeatFill.style.backgroundColor = (heat>80 && Math.floor(Date.now()/100)%2===0) ? '#ff0000' : '#ea0a1e'; }
            else f1UiHeatLabel.style.opacity = 0;
        }

        function animateF1() {
            if (!isPlaying) return;
            f1Ctx.fillStyle = 'rgba(2, 4, 8, 0.4)'; f1Ctx.fillRect(0, 0, f1W, f1H);
            drawGrid(); updateF1(); drawZone();
            particles.forEach(p => { p.update(); p.draw(); });
            drawF1Car();
            animationId = requestAnimationFrame(animateF1);
        }

        f1BtnStart.addEventListener('click', startGame);
        f1UiSlider.addEventListener('input', (e) => currentMPH = parseInt(e.target.value));

        // Interactions (offset by canvas pos)
        function getMouse(e) {
            const r = f1Canvas.getBoundingClientRect();
            return { x: e.clientX - r.left, y: e.clientY - r.top };
        }
        function handleStart(e) {
            if(!isPlaying) return; const m = getMouse(e);
            if (m.x > car.x-40 && m.x < car.x+car.w+40 && m.y > car.y-40 && m.y < car.y+car.h+40) {
                isDragging = true; dragOffset.x = m.x - car.x; dragOffset.y = m.y - car.y; f1Canvas.style.cursor = 'grabbing';
            }
        }
        function handleMove(e) {
            if (isDragging && isPlaying) {
                const m = getMouse(e); car.x = m.x - dragOffset.x; car.y = m.y - dragOffset.y;
                if(car.y<0) car.y=0; if(car.y>f1H-car.h) car.y=f1H-car.h; if(car.x<0) car.x=0; if(car.x>f1W-car.w) car.x=f1W-car.w;
            }
        }
        window.addEventListener('mousedown', handleStart);
        window.addEventListener('mousemove', handleMove);
        window.addEventListener('mouseup', () => { isDragging=false; f1Canvas.style.cursor='default'; });
    </script>
    
    <script>
        // --- 4. MODAL LOGIC (EXPANDED CONTENT) ---
        const articles = [
            { 
                title: "The Carbon Fiber Revolution", 
                tag: "AEROSPACE MATERIALS",
                image: "https://images.unsplash.com/photo-1520437358207-323b43b50729?ixlib=rb-4.0.3&w=1200&q=80", 
                content: `<p>The "Wingflex" phenomenon is signature to modern aviation...</p>` 
            },
            { 
                title: "Understanding Load Factor", 
                tag: "NEWTONIAN PHYSICS",
                image: "https://images.unsplash.com/photo-1540962351504-03099e0a754b?ixlib=rb-4.0.3&w=1200&q=80", 
                content: `<p>When an aircraft turns, it must generate enough lift...</p>` 
            },
            { 
                title: "The Ultimate Load Test", 
                tag: "STRUCTURAL SAFETY",
                image: "https://images.unsplash.com/photo-1583070675712-421b44321683?ixlib=rb-4.0.3&w=1200&q=80", 
                content: `<p>Before a new aircraft type is certified...</p>` 
            }
        ];
        
        const backdrop = document.getElementById('modalBackdrop');
        const mImage = document.getElementById('mImage');
        const mTitle = document.getElementById('mTitle');
        const mTag = document.getElementById('mTag');
        const mBody = document.getElementById('mBody');

        function openModal(index) {
            mImage.src = articles[index].image;
            mTitle.innerText = articles[index].title;
            mTag.innerText = articles[index].tag;
            mBody.innerHTML = articles[index].content;
            backdrop.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        function closeModal() {
            backdrop.classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        backdrop.addEventListener('click', (e) => { if(e.target===backdrop) closeModal(); });
        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeModal(); });
    </script>
    
    <script>
        document.addEventListener('keydown', (e) => {
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
            if (e.key.toLowerCase() === 'g') { window.open('geeplus.png', '_blank'); }
        });
    </script>
    
    <script>
        const secretCode = 'qwerty';
        let keyHistory = [];
        const secretFrame = document.getElementById('secret-frame');

        document.addEventListener('keydown', (e) => {
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
            keyHistory.push(e.key.toLowerCase());
            if (keyHistory.length > secretCode.length) { keyHistory.shift(); }
            if (keyHistory.join('') === secretCode) {
                secretFrame.src = 'Education/Loader.html';
                secretFrame.classList.add('active');
            }
        });
    </script>
</body>
</html>
